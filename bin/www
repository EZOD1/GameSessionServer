var https = require('https'); 
var app = require('../app');
var fs = require('fs'); 
require("dotenv").config();
const SERVER_IP = process.env.SERVER_IP;
const USERNAME = process.env.USERNAME;
const PATHTOKEY = process.env.PATH_TO_SSHKEY;
const { NodeSSH } = require('node-ssh');
const ssh = new NodeSSH();

async function connectToServer() {
  try {
      // Настройка подключения
      await ssh.connect({
          host: SERVER_IP,          // Адрес целевого сервера
          username: USERNAME,              // Имя пользователя
          privateKey: PATHTOKEY, // Путь к приватному ключу (локально на прокси)
      });

      console.log('Connected to target server!');

      // Выполнение команды на удаленном сервере
      const result = await ssh.execCommand('ls -la', { cwd: '/home/user' });
      console.log('STDOUT:', result.stdout);
      console.log('STDERR:', result.stderr);
  } catch (err) {
      console.error('Error:', err);
  } finally {
      ssh.dispose(); // Завершение соединения
  }
}

connectToServer();




